plumber::plumb(file='plumber.R')$run()
setwd("D:/Documents/Poste_UN/Projet_Automatisation/onu_rdc_dashboard/api")
plumb(file='C:/Users/gradi/AppData/Local/Temp/Rar$DIa5552.19327/plumber.R')$run()
# 2) (option recommandé) charge .env si tu ne l'as pas déjà mis en haut de plumber.R
if (requireNamespace("dotenv", quietly = TRUE) && file.exists("../.env")) dotenv::load_dot_env("../.env")
# 3) Démarre l'API
library(plumber)
pr <- plumber::pr("plumber.R")
print(pr)  # doit afficher la liste des endpoints
pr$run(host = "127.0.0.1", port = 8000)
plumb(file='C:/Users/gradi/AppData/Local/Temp/Rar$DIa5552.19327/plumber.R')$run()
# 1) Va dans le dossier qui contient plumber.R
setwd("D:/Documents/Poste_UN/Projet_Automatisation/onu_rdc_dashboard/api")
# 2) (option recommandé) charge .env si tu ne l'as pas déjà mis en haut de plumber.R
if (requireNamespace("dotenv", quietly = TRUE) && file.exists("../.env")) dotenv::load_dot_env("../.env")
# 3) Démarre l'API
library(plumber)
pr <- plumber::pr("plumber.R")
print(pr)  # doit afficher la liste des endpoints
pr$run(host = "127.0.0.1", port = 8000)
library(DBI)
library(RPostgres)
con <- dbConnect(
RPostgres::Postgres(),
host = "metro.proxy.rlwy.net",
port = 11124,
user = "postgres",
password = "DMSukohUiIsSxYhySDUydzIEfMxqroxQ",
dbname = "railway",
sslmode = "require"
)
con
DBI::dbListTables(con)
ls()
ls()
setwd("D:/Documents/Poste_UN/Projet_Automatisation/onu_rdc_dashboard/etl/data_final")
list.files()
df <- read.csv("export_latest.csv", stringsAsFactors = FALSE)
dim(df)
names(df)
DBI::dbWriteTable(con, "indicator_values", df, overwrite = TRUE)
df <- read.csv("export_latest.csv", fileEncoding = "CP1252", stringsAsFactors = FALSE)
to_utf8 <- function(x) {
if (is.character(x)) iconv(x, from = "CP1252", to = "UTF-8")
else x
}
df <- as.data.frame(lapply(df, to_utf8), stringsAsFactors = FALSE)
DBI::dbWriteTable(con, "indicator_values", df, overwrite = TRUE)
DBI::dbListTables(con)
DBI::dbGetQuery(con, "SELECT COUNT(*) AS n FROM indicator_values;")
DBI::dbGetQuery(con, "SELECT * FROM indicator_values LIMIT 5;")
